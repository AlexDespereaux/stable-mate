CREATE DATABASE IF NOT EXISTS annomate;
USE annomate;

DROP TABLE legend;
DROP TABLE images;
DROP TABLE users;

CREATE TABLE IF NOT EXISTS users (
  userId        INT UNSIGNED NOT NULL AUTO_INCREMENT,
  password      CHAR(60),
  email         VARCHAR(255) UNIQUE,
  admin         BOOLEAN,
  PRIMARY KEY(userId)
);

CREATE TABLE IF NOT EXISTS images (
  imageId       INT UNSIGNED NOT NULL AUTO_INCREMENT,
  filename      VARCHAR(100) NOT NULL,
  description   TEXT,
  notes         TEXT,
  datetime      INT UNSIGNED NOT NULL,
  latitude      DECIMAL(20, 10),
  longitude     DECIMAL(20, 10),
  dFov          DECIMAL(10, 5),
  ppm           DECIMAL(10, 5),
  userId        INT UNSIGNED NOT NULL,
  PRIMARY KEY(imageId),
  FOREIGN KEY(userId) REFERENCES users(userId)
);

CREATE TABLE IF NOT EXISTS legend (
  legendId      INT UNSIGNED NOT NULL AUTO_INCREMENT,
  imageId       INT UNSIGNED NOT NULL,
  name          VARCHAR(100) NOT NULL,
  text          TEXT NOT NULL,
  PRIMARY KEY(legendId),
  FOREIGN KEY(imageId) REFERENCES images(imageId)
);

INSERT INTO users (password, email, admin) VALUES ("$2a$10$2Bt1cfLDfKxpD7GmuN/TE.4WPqw1lRhPSwpHjSkA7s0f6mursAKZy", "richard", true);
INSERT INTO users (password, email, admin) VALUES ("$2a$10$Ocqnfky.r6gWd9Q2M9hrvuswbNY1TxPunmvN2ScFSsqQQtx1PDKKq", "marita", true);
INSERT INTO users (password, email, admin) VALUES ("$2a$10$cUZr5SVr2ptNKM4vNYxVV.eIKH1p9csoKFwAGuOiOpMfY9ouUXbB.", "alex", true);
INSERT INTO users (password, email, admin) VALUES ("$2a$10$1xt71keywUlzrGlgq1cpbuPuta6WZ7GaTYHk3i/LuToYgP3M2BuvC", "jackson", true);
INSERT INTO users (password, email, admin) VALUES ("$2a$10$qrjztR8Bwidh1R2dNTFmhecCoxB7nqXi115x.8bNE3peDfxU.Tu42", "anmol", true);